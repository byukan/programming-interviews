var START_URL='/next';var _CURRENT_PAGE_='_CURRENT_PAGE_';window.isIdentified=false;window.dontFireAnalytics=false;window.dontFireAnalytics=window.dontFireAnalytics&&window.DEBUG;window.sendUsAMessage=function(){window.olark('api.box.expand')
return false;};window.fbAsyncInit=function(){FB.Event.subscribe('edge.create',function(url,htmlElement){var which=$(htmlElement).data('which');utils.track('FB Like',{'which':which});});FB.Event.subscribe('edge.remove',function(url,htmlElement){var which=$(htmlElement).data('which');utils.track('FB unlike',{'which':which});});FB.Event.subscribe('message.send',function(url,htmlElement){var which=$(htmlElement).data('which');utils.track('FB message',{'which':which});});};$.fn.highlightFlash=function(onlyIfVisible){if(onlyIfVisible&&this.is(':hidden'))return;this.removeClass('highlight-flash');var that=this;setTimeout(function(){that.addClass('highlight-flash');},100);}
$.fn.fadeOutBlock=function(callback){var that=this;this.animate({opacity:0},function(){if(callback){callback();}
that.css('visibility','hidden');});};$.fn.fadeInBlock=function(callback){this.css('visibility','visible');this.animate({opacity:1},callback);};$.fn.scrollTo=function(paddingTop,delay,duration){var that=this;setTimeout(function(){$('html,body').animate({scrollTop:that.offset().top- paddingTop,},duration);},delay);};$.fn.toHTMLStr=function(){return $('<div>').append(this.clone()).html();};$.fn.isCSSHidden=function(){return this.is(":hidden")||this.css('visibility')==='hidden';}
$.fn.isOnScreen=function(fully,ignoreIsVisible,ignoreVertical,ignoreHorizontal){if(!ignoreIsVisible&&this.isCSSHidden())return false;var win=$(window);var viewport={top:win.scrollTop(),left:win.scrollLeft()};viewport.right=viewport.left+ win.width();viewport.bottom=viewport.top+ win.height();var bounds=this.offset();bounds.right=bounds.left+ this.outerWidth();bounds.bottom=bounds.top+ this.outerHeight();if(fully){var horizontalOutOfBounds=viewport.right<bounds.right||viewport.left>bounds.left;var verticalOutOfBounds=viewport.bottom<bounds.bottom||viewport.top>bounds.top;}
else{var horizontalOutOfBounds=viewport.right<bounds.left||viewport.left>bounds.right;var verticalOutOfBounds=viewport.bottom<bounds.top||viewport.top>bounds.bottom;}
return!((!ignoreVertical&&verticalOutOfBounds)||(!ignoreHorizontal&&horizontalOutOfBounds));};$.fn.isFullyOnScreen=function(ignoreIsVisible,ignoreVertical,ignoreHorizontal){return this.isOnScreen(true,ignoreIsVisible,ignoreVertical,ignoreHorizontal);};$.fn.getTextSiblingToRight=function(){var el_node_found=false;var el_node=this[0]
siblings=$(this).parent().find(":not(iframe)").addBack().contents();for(var i=0;i<siblings.length;i++){if(siblings[i]==el_node){el_node_found=true;}
else if(el_node_found&&siblings[i].nodeType==3){return siblings[i];}}};analytics.on('identify',function(userId,traits,options){if(window.DEBUG){if(JSON&&JSON.stringify){traits=JSON.stringify(traits);options=JSON.stringify(options);}
utils.logDebug('fired identify callback from analyticsjs: id:'+ userId+', '+ traits+', '+ options);}});analytics.on('track',function(event,properties,options){if(window.DEBUG){if(JSON&&JSON.stringify){properties=JSON.stringify(properties);options=JSON.stringify(options);}
utils.logDebug('fired track callback from analyticsjs: '+ event+', '+ properties+', '+ options);}});var utils={}
utils.getQueryStrVar=function(variable){var query=window.location.search.substring(1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable){return pair[1];}}
return(false);};utils.logDebug=function(thing){if(window.DEBUG){console.log(thing);}}
utils.identify=function(id,traits,context){if(window.DEBUG){retval=utils.logDebug('firing identify event: '+ id+', '+ traits+', '+ context);utils.logDebug(traits);}
if(!window.dontFireAnalytics){retval=analytics.identify(id,traits,context);}
window.isIdentified=true;return retval;};utils.track=function(action,properties,options,callback){utils.asSoonAs(function(){return window.isIdentified},function(){if(window.DEBUG){utils.logDebug('firing track event: '+ action+', '+ properties+', '+ options+', '+ callback);utils.logDebug(properties);if(window.dontFireAnalytics){return callback?callback():false;}}
if(!window.dontFireAnalytics){var callbackPending={'is':!!callback};var callbackAugmented=function(){if(callbackPending['is']){callbackPending['is']=false;return callback?callback():false;}};retval=analytics.track(action,properties,options,callbackAugmented);setTimeout(function(){if(callbackPending['is']){console.log('UH-OH: the analytics callback never got called. calling it manually.');return callbackAugmented();}},800);}});};utils.asSoonAs=function(conditionChecker,callback,onGiveUp,tries,maxTries){maxTries=maxTries?maxTries:100;if(tries>maxTries){console.log('couldnt do it. took too long.');console.log(conditionChecker);console.log('doing this instead:');console.log(onGiveUp);return onGiveUp();}
if(!conditionChecker()){tries=tries?tries:0;setTimeout(function(){utils.asSoonAs(conditionChecker,callback,onGiveUp,tries+1,maxTries);},50);return;}
return callback();};utils.trackLink=function(elements,action,properties){utils.logDebug(properties);return analytics.trackLink($(elements),action,properties);};utils.randItemInList=function(list,not,equals){if(not){if(!equals){equals=function(a,b){return a==b};}
roll=utils.randItemInList(list);if(equals(roll,not)){return utils.randItemInList(list,not,equals);}
return roll;}
return list[_.random(list.length- 1)];};utils.questionsEqual=function(q1,q2){return q1.slug==q2.slug;};utils.trim=function(element){var scopeSpan=element.find('.ng-scope')
scopeSpan.text(scopeSpan.text().trim());};utils.Money={};utils.Money.penniesToDecimalDollars=function(pennies){return pennies/100.0;}
window.redraw=function(){$(window).trigger('redraw');}
$(window).on('resize',window.redraw);$(window).on('scroll',window.redraw);var section_headings={breakdown:'Breakdown',solution:'Solution',complexity:'Complexity',gotchas:'Gotchas',bonus:'Bonus',learnings:'What We Learned',};var API_ROOT='/api/v1/'
angular.module('techPrepServices',['djangoRESTResources']).factory('NotepadContent',['$http',function($http){var getSavedNotepadContent=function(slug){return $http.get(API_ROOT+'notepad-content/',{params:{slug:slug}});};var updateOrCreateNotepadContent=function(slug,content,language){return $http.post(API_ROOT+'notepad-content/',{slug:slug,content:content,language:language});};var updateNotepadContent=function(id,content,language){return $http.put(API_ROOT+'notepad-content/',{id:id,content:content,language:language});};return{getSavedNotepadContent:getSavedNotepadContent,updateOrCreateNotepadContent:updateOrCreateNotepadContent,updateNotepadContent:updateNotepadContent,}}]).factory('RunCode',['$http',function($http){return{execute:function(language,code,user_id){var random4Digits=(''+ Math.random()).substring(2,6);var uniqueID=['IC',Date.now(),user_id,random4Digits].join('_');return $http.post(API_ROOT+'run-code/',{type:'request',id:uniqueID,language:language,code:code});}}}]).factory('Viewings',['djResource',function(djResource){return djResource(API_ROOT+'viewings/:id/',{},{update:{method:'PUT'}});}]).factory('QuestionDrafts',['djResource',function(djResource){return djResource(API_ROOT+'question_drafts/:id/',{},{update:{method:'PUT'}});}]).factory('Payment',['$http',function($http){return{purchaseWithToken:function(token){return $http.post(API_ROOT+"purchase",{token:token});},};}]).factory('PayPal',['$http',function($http){var setCheckout=function(){return $http.post(API_ROOT+'paypal/express/set');};var doCheckout=function(token,payerId){return $http.post(API_ROOT+'paypal/express/do',{token:token,payerId:payerId});};return{setCheckout:setCheckout,doCheckout:doCheckout,}}]).factory('CurrentUser',['$http','resourceCache',function($http,resourceCache){var userPromise;var times=0;var fetchCurrentUser=function(){times+=1;if(times>1){utils.logDebug('HOLY WOW. WE ARE FETCHING THE USER MORE THAN ONCE, WHICH SUCKS');}
utils.logDebug('fetching the user from db--should only do this once');return $http({method:'GET',url:API_ROOT+'current-user/',cache:resourceCache,}).then(function(response){currentUser=response.data;currentUser.getNumFreeQuestionsLeft=function(){return Math.max(this.num_free_questions_left-1,0);};return currentUser;},function(error){console.log("ERROR GETTING CURRENT USER");console.log(error);return false;});};var getCurrentUser=function(){if(!userPromise){userPromise=fetchCurrentUser();}
return userPromise;};var agreeToLatestTerms=function(){return $http.post(API_ROOT+"current-user/agree-to-latest-terms",{}).then(function(response){return response.data;},function(error){console.log("ERROR MARKING CURRENT USER AS AGREED TO LATEST TERMS");console.log(error);return false;});};var markInterestedInEmailNewsletter=function(yesNo,emailAddress){return $http.post(API_ROOT+"current-user/interested-in-email-newsletter",{interested:yesNo,email:emailAddress});};var markInterestedInIntros=function(yesNo){return $http.post(API_ROOT+"current-user/interested-in-intros",{interested:yesNo}).then(function(response){return response.data;},function(error){console.log("ERROR MARKING USER INTEREST IN RECRUITING");console.log(error);return false;});};var recruitingSetMoreInfoUrl=function(url){return $http.post(API_ROOT+"current-user/interested-in-intros",{more_info_url:url}).then(function(response){return response.data;},function(error){console.log("ERROR SETTING CURRENT USER MORE INFO URL");console.log(error);return false;});};var recruitingSetEmail=function(emailAddress){return $http.post(API_ROOT+"current-user/interested-in-intros",{email:emailAddress}).then(function(response){return response.data;},function(error){console.log("ERROR SETTING CURRENT USER EMAIL ADDRESS");console.log(error);return false;});};var confirmPreferredEmail=function(preferred_email){return $http.post(API_ROOT+'current-user/confirm-preferred-email',{preferred_email:preferred_email});};var setPreferredContentLanguage=function(language){return $http.post(API_ROOT+'current-user/set-preferred-content-language',{preferred_content_language:language}).then(function(response){return response.data;},function(error){utils.track('Error setting current user preferred content language',{'error':error});console.log('ERROR SETTING CURRENT USER PREFERRED CONTENT LANGUAGE');console.log(error);return false;});};var setPreferredNotepadLanguage=function(language){return $http.post(API_ROOT+'current-user/set-preferred-notepad-language',{preferred_notepad_language:language}).then(function(response){return response.data;},function(error){utils.track('Error setting current user preferred notepad language',{'error':error});console.log('ERROR SETTING CURRENT USER PREFERRED NOTEPAD LANGUAGE');console.log(error);return false;});};var identify=function(extraTraits){getCurrentUser().then(function(currentUser){var traits={created:new Date(currentUser.date_joined),email:currentUser.email,firstName:currentUser.first_name,lastName:currentUser.last_name,name:currentUser.full_name,username:currentUser.username,isAnonymous:currentUser.is_anonymous,isOnLastQuestion:currentUser.is_on_last_question,percentDone:currentUser.percent_done,numQuestionsDone:currentUser.num_questions_done,numQuestionsRemaining:currentUser.num_questions_remaining,isFullAccess:currentUser.is_full_access,'First Bought Full Access':currentUser.first_payment_date,'first_bought_full_access':currentUser.first_payment_date,'last_bought_full_access':currentUser.last_payment_date,'num_free_questions_left':currentUser.num_free_questions_left,'num_auth_providers':currentUser.num_auth_providers,'auth_providers_human_readable_list':currentUser.auth_providers_human_readable_list,'auth_email':currentUser.auth_email,};if(waffle&&waffle.FLAGS&&Object.keys(waffle.FLAGS).length>0){Object.keys(waffle.FLAGS).forEach(function(flag,index){traits['waffle_'+ flag]=waffle.FLAGS[flag];});}
if(extraTraits){$.extend(traits,extraTraits);}
utils.identify(currentUser.id,traits);});};return{getCurrentUser:getCurrentUser,markInterestedInIntros:markInterestedInIntros,recruitingSetMoreInfoUrl:recruitingSetMoreInfoUrl,recruitingSetEmail:recruitingSetEmail,agreeToLatestTerms:agreeToLatestTerms,markInterestedInEmailNewsletter:markInterestedInEmailNewsletter,confirmPreferredEmail:confirmPreferredEmail,setPreferredContentLanguage:setPreferredContentLanguage,setPreferredNotepadLanguage:setPreferredNotepadLanguage,identify:identify,}}]).factory('Quiz',['$http',function($http){return{nextQuestion:function(currentQuestionSlug,questionIsEmbedded){var queryVars={}
if(currentQuestionSlug){queryVars['current_question_slug']=currentQuestionSlug;}
if(questionIsEmbedded){queryVars['question_is_embedded']=questionIsEmbedded;}
queryStr=$.param(queryVars);if(queryStr){queryStr='?'+ queryStr;}
return $http.get(API_ROOT+"get-next-question/"+queryStr).then(function(response){return response;},function(error){console.log("ERROR GETTING NEXT QUESTION");console.log(error);return error;});},};}]).factory('InteractionService',['$rootScope','$window','$document',function($rootScope,$window,$document){var _SCROLL_BROKEN_='_SCROLL_BROKEN_';var _CLICK_BROKEN_='_CLICK_BROKEN_';var _NEWSLETTER_DRAWER_BLOCKED_='_NEWSLETTER_DRAWER_BLOCKED_';var _NEWSLETTER_DRAWER_FULLY_UNBLOCKED_='_NEWSLETTER_DRAWER_FULLY_UNBLOCKED_';var isScrollBroken=false;var isClickBroken=false;var newsletterDrawerBlocks=[];angular.element($window).bind("scroll",function(){if(!isScrollBroken&&this.pageYOffset>200){$rootScope.$broadcast(_SCROLL_BROKEN_);isScrollBroken=true;}});angular.element($document).bind("click",function(){if(!isClickBroken){$rootScope.$broadcast(_CLICK_BROKEN_);isClickBroken=true;}});var onClickBroken=function($scope,handler){$scope.$on(_CLICK_BROKEN_,function(event,args){handler(args);});};var onScrollBroken=function($scope,handler){$scope.$on(_SCROLL_BROKEN_,function(event,args){handler(args);});};var unblockNewsletterDrawer=function(blockName){var indexOf=newsletterDrawerBlocks.indexOf(blockName);if(blockName==null){utils.logDebug('null newsletter drawer block name. we might have a block with the name null, but we\'re going to assume this is a mistake and return false instead of trying to lift a block with a null name');return false;}
if(indexOf==-1){utils.logDebug('that newsletter drawer block wasn\'t in the list of blocks, so we couldn\t lift it: '+ blockName);return false;}
else{utils.logDebug('lifting newsletter drawer block: '+ blockName);newsletterDrawerBlocks.splice(indexOf,1);if(newsletterDrawerBlocks.length==0){$rootScope.$broadcast(_NEWSLETTER_DRAWER_FULLY_UNBLOCKED_);}
return true;}};var blockNewsletterDrawer=function(blockName){if(blockName==null){utils.logDebug('null newsletter drawer block name. we\'ll still do it, note that currently null-named blocks are un-liftable');return true;}
if(newsletterDrawerBlocks.indexOf(blockName)==-1){utils.logDebug('adding new newsletter drawer block: '+ blockName);newsletterDrawerBlocks.push(blockName);$rootScope.$broadcast(_NEWSLETTER_DRAWER_BLOCKED_);return true;}
else{utils.logDebug('that newsletter drawer block already exists, so we didnt add it again: '+ blockName);return false;}};var onNewsletterDrawerBlocked=function($scope,handler){$scope.$on(_NEWSLETTER_DRAWER_BLOCKED_,function(event,args){handler(args);});};var onNewsletterDrawerFullyUnblocked=function($scope,handler){$scope.$on(_NEWSLETTER_DRAWER_FULLY_UNBLOCKED_,function(event,args){handler(args);});};var onElementScrollInOut=function(element,onScrollIn,onScrollOut,fireInIfStartsIn,fireOutIfStartsOut){var $element=$(element);window.el=element;$element.visible=$element.isOnScreen();$(window).on('scroll resize',_.throttle(function(){var wasVisible=$element.visible;var isVisible=$element.isOnScreen();$element.visible=isVisible;if(isVisible&&(fireInIfStartsIn||!wasVisible)){onScrollIn();}
else if(!isVisible&&(fireOutIfStartsOut||wasVisible)){onScrollOut();}},50));};return{onScrollBroken:onScrollBroken,onClickBroken:onClickBroken,onElementScrollInOut:onElementScrollInOut,blockNewsletterDrawer:blockNewsletterDrawer,unblockNewsletterDrawer:unblockNewsletterDrawer,newsletterDrawerBlocks:newsletterDrawerBlocks,onNewsletterDrawerBlocked:onNewsletterDrawerBlocked,onNewsletterDrawerFullyUnblocked:onNewsletterDrawerFullyUnblocked,}}]).factory('LoginModalService',['$rootScope',function($rootScope){var _SHOW_LOGIN_MODAL_='_SHOW_LOGIN_MODAL_';var _HIDE_LOGIN_MODAL_='_HIDE_LOGIN_MODAL_';var showLoginModal=function(args){$rootScope.$broadcast(_SHOW_LOGIN_MODAL_,args);};var onShowLoginModal=function($scope,handler){$scope.$on(_SHOW_LOGIN_MODAL_,function(event,args){handler(args);});};var hideLoginModal=function(args){$rootScope.$broadcast(_HIDE_LOGIN_MODAL_,args);};var onHideLoginModal=function($scope,handler){$scope.$on(_HIDE_LOGIN_MODAL_,function(event,args){handler(args);});};return{showLoginModal:showLoginModal,onShowLoginModal:onShowLoginModal,hideLoginModal:hideLoginModal,onHideLoginModal:onHideLoginModal,}}]).factory('ConfirmPreferredEmailModalService',['$rootScope','$http',function($rootScope,$http){var _SHOW_CONFIRM_EMAIL_MODAL_='_SHOW_CONFIRM_EMAIL_MODAL_';var _HIDE_CONFIRM_EMAIL_MODAL_='_HIDE_CONFIRM_EMAIL_MODAL_';var showConfirmPreferredEmailModal=function(args){$rootScope.$broadcast(_SHOW_CONFIRM_EMAIL_MODAL_,args);};var onShowConfirmPreferredEmailModal=function($scope,handler){$scope.$on(_SHOW_CONFIRM_EMAIL_MODAL_,function(event,args){handler(args);});};var hideConfirmPreferredEmailModal=function(args){$rootScope.$broadcast(_HIDE_CONFIRM_EMAIL_MODAL_,args);};var onHideConfirmPreferredEmailModal=function($scope,handler){$scope.$on(_HIDE_CONFIRM_EMAIL_MODAL_,function(event,args){handler(args);});};return{showConfirmPreferredEmailModal:showConfirmPreferredEmailModal,onShowConfirmPreferredEmailModal:onShowConfirmPreferredEmailModal,hideConfirmPreferredEmailModal:hideConfirmPreferredEmailModal,onHideConfirmPreferredEmailModal:onHideConfirmPreferredEmailModal,}}]).factory('PaywallService',['$rootScope',function($rootScope){var _SHOW_PAYWALL_='_SHOW_PAYWALL_'
var showPaywall=function(args){$rootScope.$broadcast(_SHOW_PAYWALL_,args);};var onShowPaywall=function($scope,handler){$scope.$on(_SHOW_PAYWALL_,function(event,args){handler(args);});};return{showPaywall:showPaywall,onShowPaywall:onShowPaywall,}}]).factory('AdvanceToNextQuestionService',['$rootScope',function($rootScope){var _ADVANCE_TO_FIRST_='_ADVANCE_TO_FIRST_';var _ADVANCE_TO_NEXT_COMFORTABLE_='_ADVANCE_TO_NEXT_COMFORTABLE_';var _ADVANCE_TO_NEXT_UNCOMFORTABLE_='_ADVANCE_TO_NEXT_UNCOMFORTABLE_';var _ADVANCE_TO_NEXT_PAID_='_ADVANCE_TO_NEXT_PAID_';var _ADVANCE_STOP_='_ADVANCE_STOP_';var advanceToFirst=function(args){$rootScope.$broadcast(_ADVANCE_TO_FIRST_,args);};var advanceToNextComfortable=function(args){$rootScope.$broadcast(_ADVANCE_TO_NEXT_COMFORTABLE_,args);};var advanceToNextUncomfortable=function(args){$rootScope.$broadcast(_ADVANCE_TO_NEXT_UNCOMFORTABLE_,args);};var advanceToNextPaid=function(args){$rootScope.$broadcast(_ADVANCE_TO_NEXT_PAID_,args);};var onAdvanceToFirst=function($scope,handler){$scope.$on(_ADVANCE_TO_FIRST_,function(event,args){handler(args);});};var onAdvanceToNextUncomfortable=function($scope,handler){$scope.$on(_ADVANCE_TO_NEXT_UNCOMFORTABLE_,function(event,args){handler(args);});};var onAdvanceToNextComfortable=function($scope,handler){$scope.$on(_ADVANCE_TO_NEXT_COMFORTABLE_,function(event,args){handler(args);});};var onAdvanceToNextPaid=function($scope,handler){$scope.$on(_ADVANCE_TO_NEXT_PAID_,function(event,args){handler(args);});};var onAnyAdvance=function($scope,handler){onAdvanceToNextComfortable($scope,handler);onAdvanceToNextUncomfortable($scope,handler);onAdvanceToFirst($scope,handler);onAdvanceToNextPaid($scope,handler);};var advanceStop=function(args){$rootScope.$broadcast(_ADVANCE_STOP_,args);};var onAdvanceStop=function($scope,handler){$scope.$on(_ADVANCE_STOP_,function(event,args){handler(args);});};var loadingAnimation=function(){$('.below-nav').fadeOutBlock(function(){$('#loading').fadeIn();});};var undoLoadingAnimation=function(){$('.below-nav').fadeInBlock();$('#loading').hide();};onAnyAdvance($rootScope,loadingAnimation);onAdvanceStop($rootScope,undoLoadingAnimation);return{advanceToFirst:advanceToFirst,advanceToNextComfortable:advanceToNextComfortable,advanceToNextUncomfortable:advanceToNextUncomfortable,advanceToNextPaid:advanceToNextPaid,onAdvanceToFirst:onAdvanceToFirst,onAdvanceToNextComfortable:onAdvanceToNextComfortable,onAdvanceToNextUncomfortable:onAdvanceToNextUncomfortable,onAdvanceToNextPaid:onAdvanceToNextPaid,onAnyAdvance:onAnyAdvance,advanceStop:advanceStop,onAdvanceStop:onAdvanceStop,}}]).factory('PurchaseModalService',['$rootScope',function($rootScope){var _SHOW_PURCHASE_MODAL_='_SHOW_PURCHASE_MODAL_';var _HIDE_PURCHASE_MODAL_='_HIDE_PURCHASE_MODAL_';var showPurchaseModal=function(args){$rootScope.$broadcast(_SHOW_PURCHASE_MODAL_,args);};var onShowPurchaseModal=function($scope,handler){$scope.$on(_SHOW_PURCHASE_MODAL_,function(event,args){handler(args);});};var hidePurchaseModal=function(args){$rootScope.$broadcast(_HIDE_PURCHASE_MODAL_,args);};var onHidePurchaseModal=function($scope,handler){$scope.$on(_HIDE_PURCHASE_MODAL_,function(event,args){handler(args);});};return{showPurchaseModal:showPurchaseModal,onShowPurchaseModal:onShowPurchaseModal,hidePurchaseModal:hidePurchaseModal,onHidePurchaseModal:onHidePurchaseModal,}}]).factory('QuestionStateService',['$rootScope',function($rootScope){var _SET_NUM_HINTS_='_SET_NUM_HINTS_';var _SET_NUM_GOTCHAS_='_SET_NUM_GOTCHAS_';var _EXPAND_ALL_='_EXPAND_ALL_';var _COLLAPSE_ALL_='_COLLAPSE_ALL_';var _SHOW_HINT_='_SHOW_HINT_';var _SHOW_GOTCHA_='_SHOW_GOTCHA_';var numHints,numGotchas,numHintsVisible,numGotchasVisible,solutionVisible,gaveUp,checkedAnswer,btnPresses;var resetState=function(){numHints=0;numGotchas=0;numHintsVisible=0;numGotchasVisible=0;solutionVisible=false;gaveUp=false;checkedAnswer=false;btnPresses=[];};resetState();var pushBtnPress=function(btnPress){btnPresses.push(btnPress)};var setNumHints=function(num){numHints=num;utils.logDebug('setting numHints to '+ num);$rootScope.$broadcast(_SET_NUM_HINTS_,num);};var setNumGotchas=function(num){numGotchas=num;utils.logDebug('setting numGotchas to '+ num);$rootScope.$broadcast(_SET_NUM_GOTCHAS_,num);};var showHint=function(){numHintsVisible+=1;utils.logDebug('num hints visible: '+numHintsVisible);$rootScope.$broadcast(_SHOW_HINT_,numHintsVisible);};var showGotcha=function(){numGotchasVisible+=1;utils.logDebug('num gotchas visible: '+numGotchasVisible);$rootScope.$broadcast(_SHOW_GOTCHA_,numGotchasVisible);};var expandAll=function(args){numHintsVisible=numHints;numGotchasVisible=numGotchas;solutionVisible=true;$rootScope.$broadcast(_EXPAND_ALL_,args);};var collapseAll=function(args){numHintsVisible=0;numGotchasVisible=0;solutionVisible=false;$rootScope.$broadcast(_COLLAPSE_ALL_,args);};var giveUp=function(){gaveUp=true;expandAll();};var checkAnswer=function(){checkedAnswer=true;expandAll();};var getGaveUp=function(){return gaveUp;};var getCheckedAnswer=function(){return checkedAnswer;};var isSolutionVisible=function(){return solutionVisible;};var getNumHintsVisible=function(){return numHintsVisible;};var getNumGotchasVisible=function(){return numGotchasVisible;};var areGotchasExhausted=function(){return numGotchasVisible>=numGotchas;};var areHintsExhausted=function(){return numHintsVisible>=numHints;};var getBtnPresses=function(){return btnPresses;};var getLastBtnPress=function(){return _.last(btnPresses);};var onExpandAll=function($scope,handler){$scope.$on(_EXPAND_ALL_,function(event,args){handler(args);});};var onCollapseAll=function($scope,handler){$scope.$on(_COLLAPSE_ALL_,function(event,args){handler(args);});};var onSetNumHints=function($scope,handler){$scope.$on(_SET_NUM_HINTS_,function(event,args){handler(args);});};var onSetNumGotchas=function($scope,handler){$scope.$on(_SET_NUM_GOTCHAS_,function(event,args){handler(args);});};var onShowHint=function($scope,handler){$scope.$on(_SHOW_HINT_,function(event,args){handler(args);});};var onShowGotcha=function($scope,handler){$scope.$on(_SHOW_GOTCHA_,function(event,args){handler(args);});};var getDataDictForAnalytics=function(){return{'Total Question Hints':numHints,'Hints Exposed':numHintsVisible,'Total Question Gotchas':numGotchas,'Gotchas Exposed':numGotchasVisible,'Is Solution Visible':solutionVisible,'Has User Given Up':gaveUp,'Has User Submitted/Chosen to Check Answer':checkedAnswer,'All Button Presses':btnPresses,};};return{setNumHints:setNumHints,setNumGotchas:setNumGotchas,expandAll:expandAll,collapseAll:collapseAll,resetState:resetState,getLastBtnPress:getLastBtnPress,getBtnPresses:getBtnPresses,pushBtnPress:pushBtnPress,getGaveUp:getGaveUp,getCheckedAnswer:getCheckedAnswer,getNumHintsVisible:getNumHintsVisible,getNumGotchasVisible:getNumGotchasVisible,isSolutionVisible:isSolutionVisible,areHintsExhausted:areHintsExhausted,areGotchasExhausted:areGotchasExhausted,giveUp:giveUp,checkAnswer:checkAnswer,showHint:showHint,showGotcha:showGotcha,onShowHint:onShowHint,onShowGotcha:onShowGotcha,onSetNumGotchas:onSetNumGotchas,onSetNumHints:onSetNumHints,onExpandAll:onExpandAll,onCollapseAll:onCollapseAll,getDataDictForAnalytics:getDataDictForAnalytics,}}]).factory('resourceCache',['$cacheFactory',function($cacheFactory){return $cacheFactory("resourceCache");}]).factory('NumberlineScrollingService',['$rootScope',function($rootScope){var _SCROLL_NUMBERLINE_='_SCROLL_NUMBERLINE_'
var scrollNumberline=function(args){$rootScope.$broadcast(_SCROLL_NUMBERLINE_,args);};var onScrollNumberline=function($scope,handler){$scope.$on(_SCROLL_NUMBERLINE_,function(event,args){handler(args);});};return{scrollNumberline:scrollNumberline,onScrollNumberline:onScrollNumberline,}}]).service('ContentLanguage',['$rootScope','CurrentUser',function($rootScope,CurrentUser){var contentLanguages=window.JS_CONSTANTS.C18N_LANGUAGES;var prismLanguages=window.JS_CONSTANTS.PRISM_LANGUAGES;var defaultC18NLanguage=window.JS_CONSTANTS.DEFAULT_C18N_LANGUAGE;var contentLanguage;var _UPDATE_LANGUAGE_='_UPDATE_LANGUAGE_';var languageShortnamesForUpgradedUsersOnly=[];if(languageShortnamesForUpgradedUsersOnly.length){CurrentUser.getCurrentUser().then(function(currentUser){if(!currentUser.is_full_access){contentLanguages.forEach(function(contentLanguage,index){if(languageShortnamesForUpgradedUsersOnly.indexOf(contentLanguage.short_name)>=0){contentLanguages.splice(index);}});}});}
var getContentLanguage=function(){if(contentLanguage)return contentLanguage;if(window.JS_VARS&&window.JS_VARS.fallback_c18n_language){return window.JS_VARS.fallback_c18n_language;}
console.log('NO CONTENT LANGUAGE SET. Returning default c18n language');utils.track('No content language set. Returning default c18n language');return defaultC18NLanguage;}
var updateLanguage=function(newLanguage,isNavbarUpdate){contentLanguage=newLanguage;$rootScope.$broadcast(_UPDATE_LANGUAGE_,newLanguage,isNavbarUpdate);};var onUpdateLanguage=function($scope,handler){$scope.$on(_UPDATE_LANGUAGE_,function(event,newLanguage,isNavbarUpdate){handler(newLanguage,isNavbarUpdate);});};var getCurrentLanguagesTranslation=function(translations){var contentLanguage=getContentLanguage();if(translations.hasOwnProperty(contentLanguage.short_name)){return translations[contentLanguage.short_name];}else if(translations.hasOwnProperty(contentLanguage.case_convention)){return translations[contentLanguage.case_convention];}else{return translations['default'];}}
return{contentLanguages:contentLanguages,prismLanguages:prismLanguages,defaultC18NLanguage:defaultC18NLanguage,getContentLanguage:getContentLanguage,updateLanguage:updateLanguage,onUpdateLanguage:onUpdateLanguage,getCurrentLanguagesTranslation:getCurrentLanguagesTranslation,};}])
var app=angular.module('prepApp',['techPrepServices','ngCookies','ngAnimate','ng','seo','ui.codemirror','sticky']).config(['$interpolateProvider',function($interpolateProvider){$interpolateProvider.startSymbol('[[');$interpolateProvider.endSymbol(']]');}]).config(['$httpProvider',function($httpProvider){app.$httpProvider=$httpProvider;}]).config(['$locationProvider',function($locationProvider){$locationProvider.html5Mode({enabled:true,requireBase:false,rewriteLinks:false}).hashPrefix('!!!');}]).filter('urlescape',function(){return encodeURIComponent;}).filter('iif',function(){return function(input,trueValue,falseValue){return input?trueValue:falseValue;};}).filter('to_trusted',['$sce',function($sce){return function(text){return $sce.trustAsHtml(text);};}]).directive('hideWhenPartiallyOffscreen',[function(){return{restrict:"A",controller:['$scope','$element','$timeout',function($scope,$element,$timeout){var updateIsOnScreen=function(evt){$scope.visibility=$element.isFullyOnScreen(true,true)?'visible':'hidden';console.log($scope.visibility);};$scope.visibility='hidden';$(window).on('resize',_.throttle(updateIsOnScreen,500));$timeout(updateIsOnScreen,200);}],};}]).directive('blocksNewsDrawerTemporarilyWhenClicked',[function(){return{restrict:"A",controller:['$element','$attrs','$timeout','InteractionService',function($element,$attrs,$timeout,InteractionService){$element.click(function(event){var blockId='temp-on-click:'+$attrs.id;InteractionService.blockNewsletterDrawer(blockId);$timeout(function(){InteractionService.unblockNewsletterDrawer(blockId);},200);});}],};}]).directive('blocksNewsDrawerWhenVisible',[function(){return{restrict:"A",controller:['$element','$attrs','$timeout','InteractionService',function($element,$attrs,$timeout,InteractionService){var blockId='when-visible:'+$attrs.id;InteractionService.onElementScrollInOut($element,function(){InteractionService.blockNewsletterDrawer(blockId);},function(){InteractionService.unblockNewsletterDrawer(blockId);},true);}],};}]).directive('compile',['$compile',function($compile){return function(scope,element,attrs){scope.$watch(function(scope){return scope.$eval(attrs.compile);},function(value){element.html(value);$compile(element.contents())(scope);});};}]).directive("tracklink",function(){return{restrict:"A",scope:{theEvent:'@',theProperties:'@'},controller:['$scope','$element','$attrs','$timeout',function($scope,$element,$attrs,$timeout){$scope.$watch('theEvent',function(){$scope.$watch('theProperties',function(){if($scope.theProperties&&$scope.theEvent){utils.trackLink($element,$scope.theEvent,angular.fromJson($scope.theProperties));}});});}],};}).directive("math",['$compile',function($compile){return{restrict:"A",templateUrl:'/partials/math.html',replace:true,transclude:true,scope:{},controller:['$scope','$element','$attrs',function($scope,$element,$attrs){$scope.getComplexityMarkup=function(){return $element.parent().scope().getComplexityMarkup();};$scope.isBlock=function(){return $attrs.hasOwnProperty('block');}}],link:function(scope,element,attrs){var latex=element.text()
var mathHolder=angular.element('<span class="hide">'+latex+'</span>')
$compile(mathHolder)(scope);var getTexCompiled=function(){return mathHolder.text()};var tex=function(){try{katex.render(getTexCompiled(),element[0]);}
catch(error){console.log('Katex typesetting error!');console.log(error);console.log(getTexCompiled());utils.track('Katex typesetting error',{error:error,tex:getTexCompiled()});element.text(getTexCompiled());}}
scope.$watch(getTexCompiled,tex);},};}]).directive("complexity",function(){return{restrict:"A",templateUrl:'/partials/complexity.html',scope:{complexity:'@complexity',showConcept:'@concept'},link:function(scope,element,attrs){var rightTextSibling=element.children().first().getTextSiblingToRight();rightTextSibling.textContent=$.trim(rightTextSibling.textContent)},controller:['$scope','$element','$attrs',function($scope,$element,$attrs){$scope.getComplexityMarkup=function(){switch($scope.complexity){case"lgn":return"\\lg{n}";break;case"nlgn":return"n\\lg{n}";break;default:return $scope.complexity;}};}]};}).directive("footnote",function(){return{restrict:"A",templateUrl:'/partials/inline-footnote.html',transclude:true,scope:{},};}).directive("heading",function(){return{restrict:"A",templateUrl:'/partials/heading.html',transclude:true,replace:true,scope:{heading:'@',hideHeading:'@'},controller:['$scope','$element','$attrs','QuestionStateService',function($scope,$element,$attrs,QuestionStateService){$scope.getHeadingText=function(){return section_headings[$scope.heading];};$scope.shouldShow=function(){if($scope.hideHeading){return false;}
if($scope.heading=='gotchas'){return QuestionStateService.getNumGotchasVisible()>=1;}
else if($scope.heading=='breakdown'){return QuestionStateService.getNumHintsVisible()>=1;}
else if($scope.heading=='question'){return false;}
return true;};}]};}).directive("note",function(){return{restrict:"A",templateUrl:'/partials/note.html',transclude:true,replace:true,scope:{number:'@number',type:'@type'},controller:['$scope','$element','$attrs','QuestionStateService',function($scope,$element,$attrs,QuestionStateService){var scrollToMeIfWeJustShowedMyNumber=function(number){if(number==$scope.number){$element.highlightFlash();$element.scrollTo(40,500);}};$scope.$watch('number',function(number){utils.logDebug('num '+$scope.number+' '+$element);});$scope.$watch('type',function(type){utils.logDebug('type '+type+' '+$element);if(type=='hint'){QuestionStateService.onShowHint($scope,scrollToMeIfWeJustShowedMyNumber);}
else if(type=='gotcha'){QuestionStateService.onShowGotcha($scope,scrollToMeIfWeJustShowedMyNumber);}});$scope.shouldShow=function(){if($scope.type=='hint'){return QuestionStateService.getNumHintsVisible()>=$scope.number;}
else if($scope.type=='gotcha'){return QuestionStateService.getNumGotchasVisible()>=$scope.number;}
return true;};}]};}).directive("section",['$timeout','QuestionStateService',function($timeout,QuestionStateService){return{restrict:"A",templateUrl:'/partials/section.html',transclude:true,replace:true,scope:{section:'@',hideHeading:'@'},controller:['$scope','$element','$attrs','QuestionStateService',function($scope,$element,$attrs,QuestionStateService){$scope.shouldShow=function(){if($scope.section=='gotchas'){return QuestionStateService.getNumGotchasVisible()>=1;}
else if($scope.section=='breakdown'){return QuestionStateService.getNumHintsVisible()>=1;}
else if($scope.section=='solution'||$scope.section=='complexity'||$scope.section=='bonus'||$scope.section=='learnings'){return QuestionStateService.isSolutionVisible();}
return true;};$scope.$watch('section',function(section){if($scope.section=='solution'){QuestionStateService.onExpandAll($scope,function(){$element.scrollTo(40,500);$element.highlightFlash()
$element.addClass('slide');});}
else if($scope.section=='complexity'||$scope.section=='bonus'||$scope.section=='learnings'){QuestionStateService.onExpandAll($scope,function(){$element.highlightFlash();$element.addClass('slide');});}
if($scope.section=='learnings'&&!window.waffle.flag_is_active('learnings')){$element.remove();}});$scope.getSectionClass=function(){return'section-'+ $scope.section};}],};}]).directive("var",function(){return{restrict:"A",templateUrl:'/partials/variable.html',transclude:true,replace:true,scope:{codeID:'@var'},controller:['$scope','$controller','$element','ContentLanguage',function($scope,$controller,$element,ContentLanguage){$controller('SpanTranslationCtrl',{$scope:$scope,$element:$element});$scope.translations=window.contentTranslations['vars'][$scope.codeID];}],};}).directive("func",function(){return{restrict:"A",templateUrl:'/partials/function.html',transclude:true,replace:true,scope:{codeID:'@func'},controller:['$scope','$controller','$element','ContentLanguage',function($scope,$controller,$element,ContentLanguage){$controller('SpanTranslationCtrl',{$scope:$scope,$element:$element});$scope.translations=window.contentTranslations['funcs'][$scope.codeID];}],};}).directive("words",function(){return{restrict:"A",templateUrl:'/partials/words.html',transclude:true,replace:true,scope:{codeID:'@words'},controller:['$scope','$element','$compile','ContentLanguage',function($scope,$element,$compile,ContentLanguage){$scope.translations=window.contentTranslations['words'][$scope.codeID];ContentLanguage.onUpdateLanguage($scope,function(newLanguage){var newCode=ContentLanguage.getCurrentLanguagesTranslation($scope.translations);$element.html(newCode);$compile($element.contents())($scope);$element.highlightFlash(true);});}],};}).directive("codeInline",function(){return{restrict:"A",templateUrl:'/partials/code-inline.html',transclude:true,replace:true,scope:{codeID:'@codeInline'},controller:['$scope','$controller','$element','ContentLanguage',function($scope,$controller,$element,ContentLanguage){$controller('SpanTranslationCtrl',{$scope:$scope,$element:$element});$scope.translations=window.contentTranslations['code-inlines'][$scope.codeID];}],};}).directive("codeBlock",function(){return{restrict:"A",templateUrl:'/partials/code-block.html',transclude:true,scope:{language:'@',codeID:'@codeBlock',warningMessage:'@'},controller:'CodeBlockTranslationCtrl',compile:function(element,attrs){return{pre:function(scope,element,attrs){},post:function(scope,element,attrs){utils.trim(element);scope.$watch('language',function(language){window.Prism.highlightElement(element.find('code')[0]);});element.find('[data-toggle="tooltip"]').tooltip();if(element.parent('.concept-explanation').length===0){var mapWidthToPercentage=function(width,firstWidth,secondWidth,firstPercent,secondPercent){var percentageInWidths=(width- firstWidth)/ ( secondWidth - firstWidth );
var valueInPercent=percentageInWidths*(secondPercent- firstPercent)+ firstPercent;return valueInPercent;};var expandCodeBlock=function(){var scrollWidth=element.children()[0].scrollWidth;var fullContentWidth;var expandedWidth;if(scrollWidth>element.width()){fullContentWidth=scrollWidth+ 15;if(window.innerWidth>849){var windowWidthPercentage=mapWidthToPercentage(window.innerWidth,850,1443,0.86,0.71);var maxWidth=Math.round(windowWidthPercentage*window.innerWidth);expandedWidth=Math.min(Math.max(fullContentWidth,680),maxWidth)+'px';}else{expandedWidth='100%';}}
element.animate({width:expandedWidth},450);};var condenseCodeBlock=function(){element.animate({width:'100%'},350);};var getIsHovered=function(){return $(element).is(":hover");};var expandOrCondenseBasedOnMouse=function(){getIsHovered()?expandCodeBlock():condenseCodeBlock();};element.mouseenter(function(){_.debounce(expandOrCondenseBasedOnMouse(),300);});element.mouseleave(function(){setTimeout(function(){_.debounce(expandOrCondenseBasedOnMouse(),300);},50);});}}};},};}).directive("animation",function(){return{restrict:"A",templateUrl:'/partials/animation_iframe.html',scope:{animation:'@',part:'@part'},controller:['$scope','$element','$attrs',function($scope,$element,$attrs){$scope.edgeUtils=window.generateEdgeUtils();$scope.getCompId=function(){return $scope.animation+'__'+ $scope.part;};}],link:function(scope,element,attrs){var iframes=element.find('iframe');iframes.attr('src','/animations/'+ scope.getCompId()+'.html'+ window.CACHEBUST_QUERY_STR);}};}).directive("concept",function(){return{restrict:"A",templateUrl:'/partials/concept.html',transclude:true,scope:{concept:'@'},controller:['$scope','$element','$attrs','ContentLanguage',function($scope,$element,$attrs,ContentLanguage){$scope.explanation=$element.find('.concept-explanation');$scope.$watch('showConcept',function(showConcept){showConcept?$scope.explanation.fadeIn():$scope.explanation.fadeOut();window.redraw();});$scope.conceptPartialUrl="/concept-inline/"+
ContentLanguage.getContentLanguage().short_name+"/"+ $scope.concept+'.html'+ window.CACHEBUST_QUERY_STR;}]};}).directive("preloadResource",["resourceCache",function(resourceCache){return{link:function(scope,element,attrs){resourceCache.put(attrs.preloadResource,element.text());}};}]).directive("ngcScroll",['$parse',function($parse){return{restrict:'A',link:function(scope,element,attrs){var eventHandler=$parse(attrs.ngcScroll);element.on('scroll',function(event){var callback=function(){eventHandler(scope,{$event:event});}
scope.$apply(callback);});}}}]).animation('.slide',function(){var NG_HIDE_CLASS='ng-hide';return{beforeAddClass:function(element,className,done){if(className===NG_HIDE_CLASS){element.slideUp(done);}},beforeRemoveClass:function(element,className,done){if(className===NG_HIDE_CLASS){element.slideDown(done);}}}}).run(['$rootScope','$cookies','$timeout',function($rootScope,$cookies,$timeout){$rootScope.log=function(variable){console.log(variable);};$rootScope.safeApply=function(fn){var phase=this.$root.$$phase;if(phase=='$apply'||phase=='$digest'){if(fn&&(typeof(fn)==='function')){fn();}}else{this.$apply(fn);}};$rootScope.alert=function(text){alert(text);};$rootScope.$on('$routeChangeSuccess',function(event,current,previous){$timeout(function(){$rootScope.htmlReady()},200);});app.$httpProvider.defaults.headers.post['X-CSRFToken']=$cookies['csrftoken'];app.$httpProvider.defaults.headers.put['X-CSRFToken']=$cookies['csrftoken'];}]).controller('StartCtrl',['$scope','Quiz',function($scope,Quiz){$scope.$parent.start();}]).controller('DoneCtrl',['$scope',function($scope){}]).controller('IntroCtrl',['$scope','Quiz',function($scope,Quiz){}]).controller('QuestionDraftCreatorCtrl',['$scope','QuestionDrafts',function($scope,QuestionDrafts){if(window.DEBUG){window.questionDraftCreatorCtrl=$scope;}
$scope.draftName;$scope.submit=function(){console.log($scope.draftName);if(!$scope.draftName){alert('You must put a question name!');return false;}
QuestionDrafts.save({name:$scope.draftName,content:'__DEFAULT__'},function(newDraft,headers){window.location.href=newDraft.href;},function(response){console.log(response);alert('ERROR: '+ JSON.stringify(response.data))});};}]).controller('EditorCtrl',['$scope','$element','$compile','QuestionStateService','QuestionDrafts',function($scope,$element,$compile,QuestionStateService,QuestionDrafts){if(window.DEBUG){window.editorScope=$scope;}
$scope.ready=false;$scope.questionDraftId;$scope.textareaContent='';$scope.previewContent='';$scope.lastSavedQuestionContent='';$scope.showCheatSheet=true;$scope.saveIfNecessary=function(){console.log('checking to see if we should save...');QuestionDrafts.get({id:$scope.questionDraftId},function(questionDraft){console.log('got back the question...');if($scope.textareaContent!=$scope.lastSavedQuestionContent){if(questionDraft.content!=$scope.lastSavedQuestionContent){alert('Someone else is editing this question now! We wont save your changes anymore. reload this page to take back edit privileges and boot the other browser tab that has this question open.');return;}
console.log('yep, we should save');$scope.saving=true;$scope.updateQuestionDraft($scope.textareaContent,function(savedQuestionDraft){$scope.lastSavedQuestionContent=savedQuestionDraft.content;$scope.saving=false;$scope.saved=true;});}});}
var default_content=$element.find('textarea.editor-textarea').val();$scope.previewContent=default_content;$scope.getPreviewContent=function(){return $scope.previewContent;}
$scope.$watch('questionDraftId',function(){QuestionDrafts.get({id:$scope.questionDraftId},function(questionDraft){$scope.ready=true;$scope.questionDraft=questionDraft;$scope.previewContent=questionDraft.content;$scope.textareaContent=questionDraft.content;$scope.lastSavedQuestionContent=questionDraft.content;});});$scope.updateQuestionDraft=function(content,callback){$scope.questionDraft.content=content;$scope.questionDraft.$update({id:$scope.questionDraft.id},callback);};$scope.updatedSinceLastDraw=false;$scope.$watch('textareaContent',function(){console.log('changed');$scope.saved=false;$scope.saving=false;$scope.updatedSinceLastDraw=true;});$scope.draw=function(){$scope.previewContent=$scope.preprocess($scope.textareaContent);};$scope.preprocess=function(q_html){var q_html_dom=$('<div>').append(q_html);var hints=q_html_dom.find('[section="breakdown"] [note]');var gotchas=q_html_dom.find('[section="gotchas"] [note]');QuestionStateService.setNumHints(hints.length);QuestionStateService.setNumGotchas(gotchas.length);var decorateNoteFactory=function(noteType){return function(number){$(this).attr('number',number+1);$(this).attr('type',noteType);};}
hints.each(decorateNoteFactory('hint'));gotchas.each(decorateNoteFactory('gotcha'));return q_html_dom.toHTMLStr();};$scope.drawLoop=function(sleepTime){setTimeout(function(){if($scope.updatedSinceLastDraw){$scope.updatedSinceLastDraw=false;$scope.safeApply(function(){$scope.draw();$scope.saveIfNecessary();});console.log('redrawing...')}
$scope.drawLoop(sleepTime);},sleepTime);};$scope.drawLoop(5000);$scope.expandAll=function(){QuestionStateService.expandAll();};$scope.collapseAll=function(){QuestionStateService.collapseAll();};$scope.cheatSheetClick=function(){$scope.showCheatSheet=!$scope.showCheatSheet;};}]).controller('CardCtrl',['$element','$scope','$rootScope','Viewings','LoginModalService','PurchaseModalService','QuestionStateService','AdvanceToNextQuestionService','$timeout',function($element,$scope,$rootScope,Viewings,LoginModalService,PurchaseModalService,QuestionStateService,AdvanceToNextQuestionService,$timeout){if(window.DEBUG){window.cardScope=$scope;window.QuestionStateService=QuestionStateService;}
var viewingStatusEnum={unexpanded:'0',expanded:'E',finished:'F',comfortable:'C',uncomfortable:'U',};$scope.btnSetsDiv=$('.btn-sets');$scope.endedQuestion=false;$scope.isSingleTrack=false;LoginModalService.onHideLoginModal($scope,function(){$scope.btnSetsDiv.fadeInBlock();});PurchaseModalService.onHidePurchaseModal($scope,function(){$scope.btnSetsDiv.fadeInBlock();});setTimeout(function(){var expand=utils.getQueryStrVar('expand');if(expand){QuestionStateService.expandAll();}},50);$scope.trackQuestionEvent=function(action,callback,tries){utils.asSoonAs(function(){return $scope.percentDoneSet},function(){state_data=QuestionStateService.getDataDictForAnalytics();state_data['Question Slug']=$scope.slug;state_data['Percent of Questions Complete']=$scope.percentDone;utils.track(action,state_data,{},callback);});};$scope.trackBtnPress=function(whichButton){$scope.trackQuestionEvent('Pressed "'+ whichButton+'"');};$scope.registerSlug=function(){console.log('registering: '+ $scope.slug);$scope.viewing=Viewings.save({question:$scope.slug,is_embedded:$scope.questionIsEmbedded});$scope.trackQuestionEvent('Loaded Question');};$scope.$watch($scope.slug,function(){if(!$scope.questionIsEmbedded){$scope.registerSlug();}});$scope.setNumHints=function(num){utils.logDebug('setting numHints to '+ num);QuestionStateService.setNumHints(num);};$scope.setNumGotchas=function(num){utils.logDebug('setting numGotchas to '+ num);QuestionStateService.setNumGotchas(num);};$scope.giveUp=function(){QuestionStateService.giveUp();$scope.trackQuestionEvent('Gave Up');$scope.markAsUncomfortable();$scope.trackFinishedQuestion();};$scope.checkAnswer=function(){QuestionStateService.checkAnswer();$scope.trackQuestionEvent('Checked Answer');$scope.trackFinishedQuestion();};$scope.trackFinishedQuestion=function(){$scope.trackQuestionEvent('Finished Question');var numQuestionsFinishedBefore=window.JS_VARS.questions_fully_attempted.length;var isThisQuestionFinishedBefore=window.JS_VARS.questions_fully_attempted.indexOf($scope.slug)>=0;if(!isThisQuestionFinishedBefore){var eventName='Finished '+(numQuestionsFinishedBefore+ 1)+' question';eventName+=(numQuestionsFinishedBefore>0?'s':'');$scope.trackQuestionEvent(eventName);}};$scope.markAsComfortable=function(callback){$scope.viewing.status=viewingStatusEnum.comfortable;$scope.updateViewing(function(){utils.logDebug('marked as comfortable');$scope.trackQuestionEvent('Marked as Expert',function(){if($scope.currentUser.is_on_last_question){$scope.trackQuestionEvent('Finished Last Question',function(){callback?callback():false;});}
else{callback?callback():false;}});});};$scope.markAsUncomfortable=function(callback){$scope.viewing.status=viewingStatusEnum.uncomfortable;$scope.updateViewing(function(){utils.logDebug('marked as uncomfortable');$scope.trackQuestionEvent('Marked as Review Later',function(){callback?callback():false;});});};$scope.updateExpandedOrFinishedIfNecessary=function(){var isExpanded=(QuestionStateService.getNumGotchasVisible()>0)||(QuestionStateService.getNumHintsVisible()>0);$scope.endedQuestion;if($scope.viewing.status==viewingStatusEnum.unexpanded){if(isExpanded){$scope.trackQuestionEvent('Expanded Question');if($scope.endedQuestion){$scope.trackQuestionEvent('Finished Question');$scope.viewing.status=viewingStatusEnum.finished;}
else{$scope.viewing.status=viewingStatusEnum.expanded;}
$scope.updateViewing();}}
else if($scope.viewing.status==viewingStatusEnum.expanded){if($scope.endedQuestion){$scope.trackQuestionEvent('Finished Question');$scope.viewing.status=viewingStatusEnum.finished;$scope.updateViewing();}}};$scope.showPress=function(){$scope.trackBtnPress('Show Answer');if($scope.questionIsEmbedded&&!QuestionStateService.getBtnPresses().length){$scope.registerSlug();}
QuestionStateService.pushBtnPress('show-answer');QuestionStateService.showGotcha();if(QuestionStateService.areGotchasExhausted()){$scope.endedQuestion=true;$scope.checkAnswer();}
$scope.updateExpandedOrFinishedIfNecessary();window.redraw();};$scope.haveAnswerPress=function(){$scope.trackBtnPress('Have Answer');if($scope.questionIsEmbedded&&!QuestionStateService.getBtnPresses().length){$scope.registerSlug();}
QuestionStateService.pushBtnPress('have-answer');if(QuestionStateService.areGotchasExhausted()){$scope.endedQuestion=true;$scope.checkAnswer();}
else{QuestionStateService.showGotcha();}
$scope.updateExpandedOrFinishedIfNecessary();window.redraw();};$scope.dontHaveAnswerPress=function(){$scope.trackBtnPress('Don\'t Have Answer');if($scope.questionIsEmbedded&&!QuestionStateService.getBtnPresses().length){$scope.registerSlug();}
QuestionStateService.pushBtnPress('dont-have-answer');if(QuestionStateService.areHintsExhausted()){$scope.endedQuestion=true;$scope.giveUp();}
else{QuestionStateService.showHint();}
$scope.updateExpandedOrFinishedIfNecessary();window.redraw();};$scope.feelExpertPress=function(){$scope.btnSetsDiv.fadeOutBlock();$scope.trackBtnPress('Feel Expert');$scope.markAsComfortable(function(){$scope.currentUser.num_questions_done++;AdvanceToNextQuestionService.advanceToNextComfortable();});};$scope.dontFeelExpertPress=function(){$scope.btnSetsDiv.fadeOutBlock();$scope.trackBtnPress('Don\'t Feel Expert');$scope.markAsUncomfortable(function(){$scope.currentUser.num_questions_done++;AdvanceToNextQuestionService.advanceToNextUncomfortable();});};$scope.nextQuestionPress=function(){$scope.btnSetsDiv.fadeOutBlock();$scope.trackBtnPress('Next Question');$scope.currentUser.num_questions_done++;AdvanceToNextQuestionService.advanceToNextUncomfortable();};$scope.getShowBtnText=function(){return"Show answer";};$scope.getHaveAnswerBtnText=function(){if(QuestionStateService.areGotchasExhausted()){return"Yes, check answer!";}
else if(QuestionStateService.getLastBtnPress()=='have-answer'){return"Yep";}
return"I have an answer";};$scope.getDontHaveAnswerBtnText=function(){if(QuestionStateService.areHintsExhausted()){return"I give up!";}
else if(QuestionStateService.getLastBtnPress()=='dont-have-answer'){return"Hm, need another hint";}
return"I need a hint";};$scope.getBtnSet=function(){if(QuestionStateService.isSolutionVisible()&&QuestionStateService.getGaveUp()){return'after-must-review';}
else if(QuestionStateService.isSolutionVisible()){return'after-option';}
return'during';}
$scope.getPromptStr=function(){if($scope.isSingleTrack){if($scope.getBtnSet()=='after-must-review'){return"We'll review this one again later.";}
else if($scope.getBtnSet()=='after-option'){return"Did you get it right?";}
return"Try to get as far as you can before showing the answer!";}
if($scope.getBtnSet()=='after-must-review'){return"We'll review this one again later.";}
else if($scope.getBtnSet()=='after-option'){return"Did you get it right?";}
else if(QuestionStateService.getLastBtnPress()=='dont-have-answer'){return"Think you have an answer now?";}
else if(QuestionStateService.getLastBtnPress()=='have-answer'){return"Still feel good about your answer?";}
return"Do you have an answer?";};$scope.updateViewing=function(callback){return $scope.viewing.$update({id:$scope.viewing.id},callback);};}]).controller('NavbarTranslationCtrl',['$scope','ContentLanguage',function($scope,ContentLanguage){$scope.contentLanguages=ContentLanguage.contentLanguages;$scope.contentLanguage=ContentLanguage.getContentLanguage();$scope.updateLanguage=ContentLanguage.updateLanguage;ContentLanguage.onUpdateLanguage($scope,function(newLanguage){$scope.contentLanguage=newLanguage;});if(window.DEBUG){window.ContentLanguage=ContentLanguage}}]).controller('CodeBlockTranslationCtrl',['$scope','$element','ContentLanguage','RunCode',function($scope,$element,ContentLanguage,RunCode){$scope.staticLanguage=false;if($element.attr('translation-highlighting')==='static'){$scope.staticLanguage=true;var languagePrism=$element.attr('language');var prismLanguages=ContentLanguage.prismLanguages;for(var i=0;i<prismLanguages.length;i++){if(prismLanguages[i].prism===languagePrism){$scope.onlyLanguage=prismLanguages[i].display_name;if(prismLanguages[i].prism==='none')$scope.onlyLanguage='';break;}}}
$scope.contentLanguages=ContentLanguage.contentLanguages;$scope.contentLanguage=ContentLanguage.getContentLanguage();$scope.updateLanguage=ContentLanguage.updateLanguage;$scope.translations=window.contentTranslations['code-blocks'][$scope.codeID];$scope.codeEl=$element.find('code');$scope.prismEls=[$scope.codeEl,$element.find('pre')];ContentLanguage.onUpdateLanguage($scope,function(newLanguage){$scope.contentLanguage=newLanguage;var newCode=ContentLanguage.getCurrentLanguagesTranslation($scope.translations);if(typeof(newCode)==='object'){$scope.warningMessage=newCode['warning_message'];newCode=newCode['code'];}else{$scope.warningMessage=null;}
if($scope.warningMessage){$element.addClass('has-warning-message');}else{$element.removeClass('has-warning-message');}
$scope.codeEl.html(newCode);if($element.attr('translation-highlighting')==='dynamic'){angular.forEach($scope.prismEls,function(prismEl){prismEl.removeClass().addClass('language-'+ newLanguage.prism);});};window.Prism.highlightElement($scope.codeEl[0]);$element.highlightFlash(true);});}]).controller('SpanTranslationCtrl',['$scope','$element','ContentLanguage',function($scope,$element,ContentLanguage){ContentLanguage.onUpdateLanguage($scope,function(newLanguage){if(!$scope.translations)return;var newCode=ContentLanguage.getCurrentLanguagesTranslation($scope.translations);$element.children('span').html(newCode);$element.highlightFlash(true);});}]).controller('NotepadCtrl',['$scope','$element','$timeout','CurrentUser','NotepadContent','RunCode','ContentLanguage',function($scope,$element,$timeout,CurrentUser,NotepadContent,RunCode,ContentLanguage){$scope.notepadMode='tab-mode';$scope.lastFocussedNotepadMode;$scope.isNotepadRelatedElementClicked=false;$scope.userCode;var notepadTabPlaceholder='Type code!';CurrentUser.getCurrentUser().then(function(currentUser){$scope.currentUser=currentUser;setLanguageFromModels();});NotepadContent.getSavedNotepadContent($scope.slug).success(function(savedContent){if(savedContent.id){$scope.notepadContent=savedContent;$scope.userCode=savedContent.content;setLanguageFromModels();}else{$scope.userCode=notepadTabPlaceholder;}}).error(function(error){console.log('ERROR GETTING SAVED CONTENT');utils.track('Error getting saved content',{error:error});$scope.userCode=notepadTabPlaceholder;}).finally(function(){$element.animate({'bottom':'0px'},1300);});$scope.codemirrorLanguages=window.JS_CONSTANTS.CODEMIRROR_LANGUAGES;var initializeCodemirror=function(_editor){$scope.codemirrorElement=_editor;_editor.on('focus',function(){if($scope.notepadMode==='tab-mode'){$scope.notepadMode=$scope.lastFocussedNotepadMode||'type-and-look-mode';refreshCodemirror();trackNotepadEvent('Clicked inside notepad');if($scope.userCode===''||$scope.userCode===notepadTabPlaceholder){$scope.userCode=$scope.selectedLanguage.notepad_template||'';}}});_editor.on('blur',function(){if(!$scope.isNotepadRelatedElementClicked){$scope.outputDisplayed=false;$scope.lastFocussedNotepadMode=$scope.notepadMode;$scope.notepadMode='tab-mode';refreshCodemirror();trackNotepadEvent('Clicked outside notepad');}});};$scope.editorOptions={indentUnit:4,cursorHeight:0.85,onLoad:initializeCodemirror,};$scope.isCodemirrorUpdated=false;var refreshCodemirror=function(){$scope.isCodemirrorUpdated=true;$timeout(function(){$scope.isCodemirrorUpdated=false;},100);};var getCodemirrorLanguage=function(languageShortName){for(var i=0;i<$scope.codemirrorLanguages.length;i++){if($scope.codemirrorLanguages[i].short_name===languageShortName){return $scope.codemirrorLanguages[i];}}
utils.track('Tried getting Codemirror language that doesn\'t exist',{languageShortName:languageShortName});return null;};var setLanguageFromModels=function(){var notepadLanguage=$scope.notepadContent?getCodemirrorLanguage($scope.notepadContent.language):null;var userLangugage=null;if($scope.currentUser&&$scope.currentUser.preferred_notepad_language){userLangugage=getCodemirrorLanguage($scope.currentUser.preferred_notepad_language);}
var defaultLanguage=getCodemirrorLanguage(ContentLanguage.defaultC18NLanguage.short_name);$scope.selectedLanguage=notepadLanguage||userLangugage||defaultLanguage;};$scope.outputDisplayed=false;$scope.runCode=function(){trackNotepadEvent('Coderunner Clicked "Run"');$scope.output=$scope.outputError=$scope.outputHelp='';RunCode.execute($scope.selectedLanguage.codewars,$scope.userCode,$scope.currentUser.id).then(function(response){if(response.data.stderr!==undefined&&response.data.stdout!==undefined){$scope.output=response.data.stdout.trim();$scope.outputError=response.data.stderr.trim();trackNotepadEvent('Coderunner Ran Successfully');}else{$scope.output='';$scope.outputError=response.data.message;trackNotepadEvent('Coderunner Ran But Missing Stdout Or Stderr');}
if(!$scope.output&&!$scope.outputError){$scope.outputHelp='Your code ran just fine, but there was no output!\n\nTry:\n- making sure you\'re RUNNING your function, not just DEFINING it\n- explicitly PRINTING values';}else{if(isOutputHelpCase('java',$scope.output,'Failed to parse java class in code')){$scope.outputHelp='You need to wrap your Java code in a class, otherwise it won\'t compile.';}else if(isOutputHelpCase('java',$scope.output,'error: class, interface, or enum expected')){$scope.outputHelp='Did you wrap your code in a class? Java code needs to be in a class to compile.';}else if(isOutputHelpCase('java',$scope.output,/java.lang.NoSuchMethodException: (.*).main/)){$scope.outputHelp='You need to have a main() method in a class as an entry point for your program.';}else if(isOutputHelpCase('csharp',$scope.outputError,"`Main' method suitable for an entry point")){$scope.outputHelp='For C#, make sure you have a Main() function!';}else if(isOutputHelpCase('csharp',$scope.outputError,"`Console' does not exist in the current context")){$scope.outputHelp='Looks like youre trying to write to the console, but havent included the System namespace.\n\nTry:\n- putting `using System;` at the top of your code, or\n- using `System.Console.WriteLine()`';}}},function(error){console.log('ERROR RUNNING CODE');console.log(error);var status=error.data.status||error.status;var message=error.data.message||error.statusText;trackNotepadEvent('Coderunner Error',{status:status,message:message,});$scope.output='';$scope.outputError='Oops! We\'re having trouble running your code.\nWe\'ll try to fix it soon.\n\n'+ status+' '+ message;});$scope.outputDisplayed=true;$scope.codemirrorElement.focus();};var isOutputHelpCase=function(languageShortName,actualOutput,expectedOutput){if($scope.selectedLanguage.short_name!==languageShortName){return false;}
if(!actualOutput){return false;}
if(typeof(expectedOutput)==="string"&&actualOutput.indexOf(expectedOutput)<0){return false;}
if(typeof(expectedOutput)==="object"&&!expectedOutput.test(actualOutput)){return false;}
return true;}
$scope.clickIcon=function(mode){if(mode==='tab-mode'){$scope.outputDisplayed=false;}else{$scope.codemirrorElement.focus();}
if($scope.notepadMode!=='tab-mode'){$scope.lastFocussedNotepadMode=$scope.notepadMode;}
$scope.notepadMode=mode;trackNotepadEvent('Clicked '+ mode+' icon');};$scope.selectFromLanguageDropdown=function(){CurrentUser.setPreferredNotepadLanguage($scope.selectedLanguage.short_name);$timeout(function(){$scope.codemirrorElement.focus();},0,false);if($scope.userCode&&$scope.notepadContent){NotepadContent.updateNotepadContent($scope.notepadContent.id,$scope.userCode,$scope.selectedLanguage.short_name);}
trackNotepadEvent('Selected language from dropdown');};$scope.$watch('selectedLanguage',function(newValue,oldValue){$scope.codemirrorElement.setOption('mode',$scope.selectedLanguage.codemirror);if(newValue===oldValue)return;if($scope.userCode===''||$scope.userCode===oldValue.notepad_template){$scope.userCode=newValue.notepad_template||'';}});var isNotepadAwesomeReported=false;$scope.$watch('userCode',_.throttle(function(newValue,oldValue){if(oldValue&&newValue&&newValue!==notepadTabPlaceholder){if($scope.notepadContent){NotepadContent.updateNotepadContent($scope.notepadContent.id,newValue,$scope.selectedLanguage.short_name);}else if(newValue!==$scope.selectedLanguage.notepad_template){NotepadContent.updateOrCreateNotepadContent($scope.slug,newValue,$scope.selectedLanguage.short_name).then(function(newContent){$scope.notepadContent=newContent.data;},function(error){if(error.status===409){console.log('NOTEPAD CONTENT ALREADY EXISTS FOR USER AND QUESTION');utils.track('Notepad content already exists for user and question',{error:error});}else{console.log('ERROR CREATING NOTEPAD CONTENT');utils.track('Error creating notepad content',{error:error});}});}
$scope.linesOfCodeCount=newValue.split("\n").length;if($scope.linesOfCodeCount>4&&!isNotepadAwesomeReported){trackNotepadEvent('Notepad awesome');isNotepadAwesomeReported=true;}}},5000));var trackNotepadEvent=function(eventMessage,properties){utils.track(eventMessage,$.extend({},properties,{'question':$scope.slug,'language':$scope.selectedLanguage.short_name,'mode':$scope.notepadMode,'linesOfCode':$scope.linesOfCodeCount,}));};$element.find('.cm-s-default').addClass('CodeMirror');}]).controller('TermsModalCtrl',['$scope','$element','CurrentUser',function($scope,$element,CurrentUser){$scope.termsModal=$element;CurrentUser.getCurrentUser().then(function(currentUser){$scope.currentUser=currentUser;if(!currentUser.is_anonymous&&!currentUser.terms_has_agreed_to_latest){$scope.termsModal.modal('show');}});$scope.agreeToTermsClick=function(){$scope.currentUser.terms_has_agreed_to_latest=true;$scope.termsModal.modal('hide');CurrentUser.agreeToLatestTerms();utils.track('Agreed to Terms');};}]).controller('HeaderCtrl',['$scope','$element','CurrentUser','LoginModalService','ContentLanguage',function($scope,$element,CurrentUser,LoginModalService,ContentLanguage){$scope.currentUserSet=false;var initialLanguage=$element.attr('language');if(initialLanguage){var contentLanguages=ContentLanguage.contentLanguages;for(var i=0;i<contentLanguages.length;i++){if(contentLanguages[i].short_name===initialLanguage){ContentLanguage.updateLanguage(contentLanguages[i]);break;}}
if(i>=contentLanguages.length){console.log('INITIALIZED LANGUAGE NOT A C18N LANGUAGE: '+ initialLanguage);utils.track('Initialized language not a C18N language',{language:initialLanguage});ContentLanguage.updateLanguage(ContentLanguage.defaultC18NLanguage);}}
CurrentUser.getCurrentUser().then(function(currentUser){$scope.currentUser=currentUser;$scope.currentUserSet=true;CurrentUser.identify();});$scope.loginClick=function(which){utils.track('Login Link Click',{'which':which});LoginModalService.showLoginModal({next:_CURRENT_PAGE_});};}]).controller('UnsubscribeFormCtrl',['$scope','$element',function($scope,$element){$scope.unsubClicked=false;$scope.captchaed=false;$scope.captchaCallback=function(){$scope.captchaed=true;$element.submit();};window.captchaCallback=$scope.captchaCallback;}]).controller('PurchaseModalCtrl',['$scope','$element','PurchaseModalService',function($scope,$element,PurchaseModalService){if(window.DEBUG){window.purchaseModalScope=$scope;}
$scope.purchaseModal=$element;$scope.next=START_URL;PurchaseModalService.onHidePurchaseModal($scope,function(args){setTimeout(function(){$('body').scrollTop($('body').scrollTop()-1);setTimeout(function(){$('body').scrollTop($('body').scrollTop()+1);},50);},50);});PurchaseModalService.onShowPurchaseModal($scope,function(args){if(args&&args.next){if(args.next==_CURRENT_PAGE_){$scope.next=document.URL;}
else{$scope.next=args.next;}}
$scope.purchaseModal.modal('show');});$scope.purchaseModal.on('hidden.bs.modal',function(){PurchaseModalService.hidePurchaseModal();});}]).controller('PurchaseFormCtrl',['$scope','$element','$timeout','Quiz','Payment','PayPal','AdvanceToNextQuestionService','CurrentUser','LoginModalService',function($scope,$element,$timeout,Quiz,Payment,PayPal,AdvanceToNextQuestionService,CurrentUser,LoginModalService){if(window.DEBUG){window.purchaseFormScope=$scope;}
$scope.justSucceeded=false;$scope.paymentFormEl=$element;$scope.cardIconEl=$scope.paymentFormEl.find('.card-icon');$scope.showLoginModal=function(args){if(!args){args={};}
if(!args.hasOwnProperty('next')){args.next=window.location.href;}
LoginModalService.showLoginModal(args);};$scope.currentUser;CurrentUser.getCurrentUser().then(function(currentUser){$scope.currentUser=currentUser;});$scope.ccForm={ccNum:{el:$scope.paymentFormEl.find('.cc-number'),isEdited:false,},expiry:{el:$scope.paymentFormEl.find('.cc-exp'),isEdited:false,},cvc:{el:$scope.paymentFormEl.find('.cc-cvc'),isEdited:false,},};$scope.ccForm.objs=[$scope.ccForm.ccNum,$scope.ccForm.expiry,$scope.ccForm.cvc];$scope.ccForm.ccNum.el.payment('formatCardNumber');$scope.ccForm.expiry.el.payment('formatCardExpiry');$scope.ccForm.cvc.el.payment('formatCardCVC');$scope.ccForm.ccNum.getVal=function(){return $scope.ccForm.ccNum.el.val();};$scope.ccForm.expiry.getVal=function(){return $scope.ccForm.expiry.el.payment('cardExpiryVal');};$scope.ccForm.cvc.getVal=function(){return $scope.ccForm.cvc.el.val();};$scope.ccForm.ccNum.isValid=function(){return $.payment.validateCardNumber($scope.ccForm.ccNum.getVal());};$scope.ccForm.expiry.isValid=function(){return $.payment.validateCardExpiry($scope.ccForm.expiry.getVal());};$scope.ccForm.cvc.isValid=function(){return $.payment.validateCardCVC($scope.ccForm.cvc.getVal(),$scope.cardType);};var validateGenerator=function(obj){return function(){obj.el.removeClass('invalid');obj.el.removeClass('valid');var isValid=obj.isValid();obj.el.toggleClass('invalid',!isValid);obj.el.toggleClass('valid',isValid);};};var markEditedGenerator=function(obj){return function(){if(!obj.isEdited){obj.isEdited=true;obj.el.bind('change paste keyup',obj.validate);}};};_.each($scope.ccForm.objs,function(obj){obj.validate=validateGenerator(obj);obj.markEdited=markEditedGenerator(obj);obj.el.focusout(obj.validate);obj.el.focusout(obj.markEdited);});$scope.disableForm=function(){$scope.paymentFormEl.find('button, input').prop('disabled',true);};$scope.enableForm=function(){$scope.paymentFormEl.find('button, input').prop('disabled',false);};$scope.updateCardType=function(){$scope.cardType=$.payment.cardType($scope.ccForm.ccNum.el.val());if(!$scope.cardType){$scope.cardType='default';}
$scope.cardIconEl.css('background-image','url("/static/images/cc-icons/32/'+$scope.cardType+'.png")')}
var showAllRows=function(){$scope.paymentFormEl.find('.formrow.expiry-cvc').slideDown();};var showRowsIfReady=function(){if($scope.ccForm.ccNum.getVal().length>4){if(!$scope.paymentFormEl.find('.formrow.expiry-cvc').is(':visible')){$scope.paymentFormEl.find('.formrow.expiry-cvc').slideDown();utils.track('Payment Form: show 2nd row');}}};$timeout(showRowsIfReady,500);$scope.ccForm.ccNum.el.bind('change paste keyup',$scope.updateCardType);$scope.ccForm.ccNum.el.bind('change paste keyup',showRowsIfReady);$scope.ccForm.ccNum.el.bind('change paste keyup',function(){if($scope.ccForm.ccNum.getVal().toString().length>=12){$scope.ccForm.ccNum.markEdited();}});$scope.ccForm.expiry.el.bind('change paste keyup',function(){var expiry=$scope.ccForm.expiry.getVal();if(expiry['month'].toString().length>=1&&expiry['year'].toString().length>=4){$scope.ccForm.expiry.markEdited();}});$scope.ccForm.cvc.el.bind('change paste keyup',function(){if($scope.ccForm.cvc.getVal().toString().length>1){$scope.ccForm.cvc.markEdited();}});$scope.errorEl=$scope.paymentFormEl.find('.payment-errors');$scope.PayPalErrorEl=$scope.paymentFormEl.find('.paypal-payment-errors');$scope.successEl=$scope.paymentFormEl.find('.payment-success');$scope.showSuccess=function(){$scope.successEl.slideDown()};$scope.showError=function(error){$scope.errorEl.text(error);$scope.errorEl.slideDown();};$scope.clearErrors=function(error){$scope.errorEl.slideUp();$scope.errorEl.text('');};$scope.showPayPalError=function(error){$scope.PayPalErrorEl.text(error);$scope.PayPalErrorEl.slideDown();$scope.payPalBuyButtonDisabled=false;};$scope.clearPayPalErrors=function(error){$scope.PayPalErrorEl.slideUp();$scope.PayPalErrorEl.text('');};var stripeResponseHandler=function(status,response){if(response.error){$scope.showError(response.error.message);$scope.enableForm();utils.track('Payment Form: Stripe JS error',{error:response.error.message});}else{var token=response.id;Payment.purchaseWithToken(token).then(function(response){$scope.justSucceeded=true;$scope.currentUser.is_full_access=true;$scope.showSuccess();utils.track('Payment Form: Success',{},{},function(){utils.track('Purchase',{payment_processor:'stripe-manual',revenue:utils.Money.penniesToDecimalDollars(window.JS_VARS.user_price_in_pennies),},{integrations:window.JS_CONSTANTS.INTEGRATIONS_SETTING_ONLY_INTEGRATIONS_THAT_SUPPORT_FRONT_END_ONLY,},function(){$timeout(function(){AdvanceToNextQuestionService.advanceToNextPaid();},500);});});},function(response){$scope.enableForm();console.log(response);var humanReadableError='An error occurred :(';if(response.data&&(typeof(response.data)==='object'&&response.data!=null)&&response.data.detail){humanReadableError=response.data.detail;}
else if(response.data){humanReadableError=response.data;}
$scope.showError('ERROR: '+ humanReadableError);utils.track('Payment Form: Back-end Error',{error:humanReadableError});});}};$scope.paymentFormEl.submit(function(event){showRowsIfReady();utils.track('Payment Form: Submitted');$scope.disableForm();$scope.clearErrors();$scope.ccForm.ccNum.validate();$scope.ccForm.expiry.validate();$scope.ccForm.cvc.validate();showAllRows();var allValid=$scope.ccForm.ccNum.isValid()&&$scope.ccForm.expiry.isValid()&&$scope.ccForm.cvc.isValid();if(allValid){Stripe.card.createToken({number:$scope.ccForm.ccNum.getVal(),cvc:$scope.ccForm.cvc.getVal(),exp_month:$scope.ccForm.expiry.getVal()['month'],exp_year:$scope.ccForm.expiry.getVal()['year'],},stripeResponseHandler);}
else{$scope.showError('Please correct the red fields');$scope.enableForm();utils.track('Payment Form: Front-end Validation Failed');}
return false;});$scope.getAndDisplayErrorsFromQuery=function(){var error=utils.getQueryStrVar('error');switch(error){case'paypal':error_message='Woops - PayPal didn\'t process the payment!';break;case'readable':error_message='An error occurred :(';break;case'terrible':error_message='Ahh! This is terrible - we successfully charged you but hit an error while upgrading your account. We just emailed ourselves and we\'ll get you sorted ASAP. We are deeply sorry!';break;default:error_message=null;}
if(error_message){$scope.showPayPalError(error_message);}};$scope.getAndDisplayErrorsFromQuery();$scope.payPalBuyButtonDisabled=false;$scope.buyWithPayPal=function(){$scope.clearPayPalErrors();if(!$scope.payPalBuyButtonDisabled){$scope.payPalBuyButtonDisabled=true;PayPal.setCheckout().then(function(response){window.location.href=response.data.checkout_url;},function(response){utils.track('Post request to paypal/express/set failed',{'status':response.status,'errorMessage':response.error_message});var errorMessageFromBackend=response.data.error_message;var errorMessageToUser=errorMessageFromBackend||'An error occurred :(';$scope.showPayPalError(errorMessageToUser);});};}}]).controller('PayPalConfirmCtrl',['$scope','$timeout','CurrentUser','PayPal','AdvanceToNextQuestionService','LoginModalService',function($scope,$timeout,CurrentUser,PayPal,AdvanceToNextQuestionService,LoginModalService){$scope.currentUser;CurrentUser.getCurrentUser().then(function(currentUser){$scope.currentUser=currentUser;if($scope.currentUser.is_anonymous){LoginModalService.showLoginModal({next:window.location.href,note:'Please log in to confirm your payment',closeable:false,});}});$scope.confirmPayPalPayment=function(){$scope.payPalConfirmButtonDisabled=true;var token=utils.getQueryStrVar('token');var payerId=utils.getQueryStrVar('PayerID');PayPal.doCheckout(token,payerId).then(function(response){$scope.currentUser.is_full_access=true;$('.payment-success').animate({'opacity':1},500);utils.track('Purchase',{payment_processor:'paypal-express',revenue:utils.Money.penniesToDecimalDollars(window.JS_VARS.user_price_in_pennies),},{integrations:window.JS_CONSTANTS.INTEGRATIONS_SETTING_ONLY_INTEGRATIONS_THAT_SUPPORT_FRONT_END_ONLY},function(){$timeout(function(){AdvanceToNextQuestionService.advanceToNextPaid();},500);});},function(response){utils.track('Post request to paypal/express/do failed',{'status':response.status,'errorMessage':response.error_message});var errorMessageFromBackend=response.data.error_message;var errorMessageToUser=errorMessageFromBackend||'readable';window.location.href="/upgrade?error="+ errorMessageToUser+"##payment-form-wrapper";});}}]).controller('LoginModalCtrl',['$scope','$element','LoginModalService',function($scope,$element,LoginModalService){var defaultNote='Log in to continue';$scope.note=defaultNote;$scope.closeable=true;$scope.loginModal=$element;$scope.next=START_URL;LoginModalService.onShowLoginModal($scope,function(args){if(!args){args={}};$scope.note=args.note?args.note:defaultNote;if(args.hasOwnProperty('closeable')){$scope.closeable=args.closeable;}
if(!$scope.closeable){$scope.loginModal.modal({'keyboard':false,'backdrop':'static',});}
else{$scope.loginModal.modal({'keyboard':false,'backdrop':true,});}
if(args&&args.next){if(args.next==_CURRENT_PAGE_){$scope.next=document.URL;}
else{$scope.next=args.next;}}
$scope.loginModal.modal('show');});$scope.loginModal.on('hidden.bs.modal',function(){LoginModalService.hideLoginModal();});}]).controller('ConfirmPreferredEmailFormCtrl',['$scope','$element','$http','$timeout','CurrentUser',function($scope,$element,$http,$timeout,CurrentUser){$scope.preferredEmail;$scope.badEmail;$scope.disabled=false;$scope.success=false;$scope.failureMessage=false;$scope.getNote=function(){if($scope.badEmail){return'What email address do you want to use?';}else{return'Is this the email address you want to use?';}};$scope.submit=function(){$scope.disabled=true;CurrentUser.confirmPreferredEmail($scope.preferredEmail).success(function(response){$scope.success=true;utils.logDebug('confirmed preferred email w/ backend');utils.logDebug(response);utils.track('Confirmed Preferred Email Through Modal',{'Email':$scope.preferredEmail});CurrentUser.getCurrentUser().then(function(currentUser){currentUser.email=$scope.preferredEmail;CurrentUser.identify();});if(response['email_is_new_to_us']){utils.track('Gave us their email',{'Email':$scope.preferredEmail,'medium':'preferred email modal',});CurrentUser.identify({'email_entry_form_id':$element.attr('id'),});}}).error(function(error){$scope.failureMessage='awww, geee. an error occurred :/ we\'ll take a look';utils.track('Error posting to confirm preferred email');console.log('ERROR POSTING TO CONFIRM PREFERRED EMAIL');console.log(error);return false;}).finally(function(){$scope.disabled=false;$timeout(function(){$scope.success=false;},3000);});}}]).controller('ConfirmPreferredEmailModalCtrl',['$scope','$element','$http','ConfirmPreferredEmailModalService','CurrentUser',function($scope,$element,$http,ConfirmPreferredEmailModalService,CurrentUser){$scope.confirmPreferredEmailModal=$element;$scope.showConfirmPreferredEmailModal=function(show_modal){setTimeout(function(){ConfirmPreferredEmailModalService.showConfirmPreferredEmailModal({});},0);};$scope.hideConfirmPreferredEmailModal=function(){setTimeout(function(){ConfirmPreferredEmailModalService.hideConfirmPreferredEmailModal({});},0);};ConfirmPreferredEmailModalService.onShowConfirmPreferredEmailModal($scope,function(args){$scope.confirmPreferredEmailModal.modal('show');});ConfirmPreferredEmailModalService.onHideConfirmPreferredEmailModal($scope,function(args){$scope.confirmPreferredEmailModal.modal('hide');});}]).controller('PrepSeshApp',['$element','$scope','$rootScope','Viewings','Quiz','LoginModalService','PurchaseModalService','PaywallService','AdvanceToNextQuestionService','CurrentUser','ContentLanguage',function($element,$scope,$rootScope,Viewings,Quiz,LoginModalService,PurchaseModalService,PaywallService,AdvanceToNextQuestionService,CurrentUser,ContentLanguage){$scope.percentDone=0;$scope.percentDoneSet=false;$scope.nextQuestionIfComfortable={};$scope.nextQuestionIfUncomfortable={};$scope.nextQuestionIfPurchase={};$scope.nextQuestionIfStart={};$scope.nextQuestionSet=false;$scope.currentUser={};$scope.currentUserSet=false;$scope.questionIsEmbedded;$scope.isFBVisitor=function(){return utils.getQueryStrVar('utm_source')=='facebook';};if(window.DEBUG){window.appScope=$scope;}
$scope.startBtns=$('.get-started');LoginModalService.onHideLoginModal($scope,function(){$scope.startBtns.fadeInBlock();AdvanceToNextQuestionService.advanceStop();});PurchaseModalService.onHidePurchaseModal($scope,function(){$scope.startBtns.fadeInBlock();});ContentLanguage.onUpdateLanguage($scope,function(newLanguage,isNavbarUpdate){if(window.JS_VARS&&window.JS_VARS.url_content_type){var contentSlug=$scope.slug||window.JS_VARS.article_slug||window.JS_VARS.concept_slug;var newURL=[window.JS_VARS.url_content_type,newLanguage.short_name,contentSlug].join('/');var queryString=window.location.search;if(queryString)newURL+=queryString;history.pushState(null,null,'/'+ newURL);}
CurrentUser.setPreferredContentLanguage(newLanguage.short_name);var dropdown=(isNavbarUpdate)?'navbar':'code-block';utils.track('Updated content language',{newLanguage:newLanguage.short_name,dropdown:dropdown});});PaywallService.onShowPaywall($scope,function(){window.location.href='/upgrade';});$scope.isNextQuestionReady=function(){return $scope.nextQuestionSet;};$scope.$watch($scope.slug,function(){utils.logDebug('slug is set to '+ $scope.slug);utils.asSoonAs($scope.isCurrentUserSet,function(){Quiz.nextQuestion($scope.slug,$scope.questionIsEmbedded).then(function(nextQuestion){if(nextQuestion&&nextQuestion.status==204){}
else if(nextQuestion&&nextQuestion.status==200){$scope.nextQuestionIfPurchase=nextQuestion.data.purchase;$scope.nextQuestionIfComfortable=nextQuestion.data.comfortable;$scope.nextQuestionIfUncomfortable=nextQuestion.data.uncomfortable;$scope.nextQuestionIfStart=nextQuestion.data.start;}
else{console.log('TROUBLE GETTING NEXT QUESTION');console.log('THIS WAS THE RESPONSE:');console.log(nextQuestion);}
$scope.nextQuestionSet=true;});});});$scope.isCurrentUserSet=function(){return $scope.currentUserSet;};CurrentUser.getCurrentUser().then(function(currentUser){$scope.currentUser=currentUser;$scope.currentUserSet=true;$scope.percentDone=currentUser.percent_done;$scope.percentDoneSet=true;});$scope.start=function(whichButton){$scope.startBtns.fadeOutBlock();utils.logDebug('starting, as soon as current user is set');utils.asSoonAs($scope.isCurrentUserSet,function(){utils.logDebug('ok, current user is set. starting.');utils.track('Pressed Start',{'Which Button':whichButton},{},function(){AdvanceToNextQuestionService.advanceToFirst();});});};AdvanceToNextQuestionService.onAdvanceToNextPaid($scope,function(){utils.asSoonAs($scope.isNextQuestionReady,function(){$scope.advanceToThisQuestionOrFinish($scope.nextQuestionIfPurchase);},function(){window.location.href=START_URL;});});AdvanceToNextQuestionService.onAdvanceToNextUncomfortable($scope,function(){utils.asSoonAs($scope.isNextQuestionReady,function(){$scope.advanceToThisQuestionOrFinish($scope.nextQuestionIfUncomfortable);},function(){window.location.href=START_URL;});});AdvanceToNextQuestionService.onAdvanceToFirst($scope,function(){utils.asSoonAs($scope.isNextQuestionReady,function(){$scope.advanceToThisQuestionOrFinish($scope.nextQuestionIfStart);},function(){window.location.href=START_URL;});});AdvanceToNextQuestionService.onAdvanceToNextComfortable($scope,function(){utils.asSoonAs($scope.isNextQuestionReady,function(){$scope.advanceToThisQuestionOrFinish($scope.nextQuestionIfComfortable);},function(){window.location.href=START_URL;});});$scope.advanceToThisQuestionOrFinish=function(nextStep){utils.logDebug('advancing to next question or finish...');if(nextStep.the_type==window.JS_CONSTANTS.next_step_type_enum.login){$scope.safeApply(function(){LoginModalService.showLoginModal({next:START_URL});});}
else{window.location.href=nextStep.url;}};}]).controller('AlertDrawerCtrl',['$scope','$element','InteractionService','CurrentUser',function($scope,$element,InteractionService,CurrentUser){if(window.DEBUG){window.alertDrawerScope=$scope;}
$scope.showing=false;$scope.shownOnce=false;$scope.hide=function(){$scope.safeApply(function(){$scope.showing=false;});}
$scope.show=function(){$scope.safeApply(function(){$scope.showing=true;if(!$scope.shownOnce){utils.track('Shown Email Newsletter Alert');$scope.shownOnce=true;}});}
var _SCROLL_BROKEN_='_SCROLL_BROKEN_';InteractionService.blockNewsletterDrawer(_SCROLL_BROKEN_);InteractionService.onScrollBroken($scope,function(){InteractionService.unblockNewsletterDrawer(_SCROLL_BROKEN_);});InteractionService.onNewsletterDrawerFullyUnblocked($scope,$scope.show);InteractionService.onNewsletterDrawerBlocked($scope,$scope.hide);$scope.$watch('type',function(){if($scope.type==='email_newsletter'){$scope.noThanksClick=function(){InteractionService.blockNewsletterDrawer('closed by user');CurrentUser.markInterestedInEmailNewsletter(false);utils.track('Email Newsletter Click: Not Interested');};}});}]).controller('EmailNewsletterSignupCtrl',['$scope','$element','CurrentUser','InteractionService',function($scope,$element,CurrentUser,InteractionService){$scope.email;$scope.disabled=false;$scope.success=false;$scope.failureMessage=false;if(window.DEBUG){window.emailNewsletterSignupScope=$scope;}
$scope.signupPress=function(){$scope.disabled=true;$scope.failureMessage=false;CurrentUser.markInterestedInEmailNewsletter(true,$scope.email).success(function(response){$scope.success=true;utils.logDebug('marked interested in email newsletter in the back-end');utils.logDebug(response);CurrentUser.identify({'email':$scope.email,'email_entry_form_id':$element.attr('id'),'email_entry_form_campaign':$element.attr('campaign'),});utils.track('Email Newsletter Click: Interested',{'Email':$scope.email});utils.track('Gave us their email',{'Email':$scope.email,'medium':'email newsletter signup','which':$element.attr('id'),'campaign':$element.attr('campaign'),});if($element.attr('id')=='home-bottom-email-mag'){setTimeout(function(){$scope.start('home-bottom-email-mag');},1000);}
setTimeout(function(){InteractionService.blockNewsletterDrawer('email submitted by user');},1000);}).error(function(error){$scope.failureMessage='awww, geee. an error occurred :/ we\'ll take a look';utils.track('Error posting to email newsletter signup');console.log("ERROR MARKING USER INTEREST IN EMAIL NEWSLETTER");console.log(error);return false;}).finally(function(){$scope.disabled=false;});};}]).controller('RecruitingSurveyCtrl',['$scope','$element','CurrentUser',function($scope,$element,CurrentUser){$scope.currentUserSet=false;$scope.show=true;$scope.step='interest';$scope.message;$scope.linkedIn;$scope.email;if(window.DEBUG){window.recruitingScope=$scope;}
utils.track('Shown Recruiting Alert');CurrentUser.getCurrentUser().then(function(currentUser){$scope.currentUser=currentUser;$scope.currentUserSet=true;$scope.email=$scope.currentUser.email;});$scope.$watch('step',function(){if($scope.step=='done'){$scope.fadeOut();}});$scope.notInterestedInIntrosPress=function(){$scope.currentUser.recruiting_is_interested_in_intros=false;CurrentUser.markInterestedInIntros(false);utils.track('Recruiting Click: Not Interested in Intros');$scope.message='Ok, no problem!';$scope.step='done';};$scope.fadeOut=function(){setTimeout(function(){$element.fadeOut();},1500);};$scope.emailSubmitPress=function(){CurrentUser.recruitingSetEmail($scope.email);$scope.message='Great! We\'ll reach out if we have something for you!';$scope.step='done';console.log($scope.email);utils.track('Recruiting Submit: Email');};$scope.infoUrlSubmitPress=function(){CurrentUser.recruitingSetMoreInfoUrl($scope.linkedIn);$scope.step='email';console.log($scope.linkedIn);utils.track('Recruiting Submit: LinkedIn URL');};$scope.interestedInIntrosPress=function(){$scope.currentUser.recruiting_is_interested_in_intros=true;CurrentUser.markInterestedInIntros(true);utils.track('Recruiting Click: Interested in Intros');$scope.step='info_url';};}]).controller('NumberlineCtrl',['$scope','$element','NumberlineScrollingService',function($scope,$element,NumberlineScrollingService){$scope.hoveringToScroll=false;$scope.scrollDirection;$scope.edgeFadeWidth=$element.find('.edge-fade').width();$scope.edgeFadePositions={'left':-$scope.edgeFadeWidth,'right':0}
$scope.toggleScroll=function(){if(!$scope.hoveringToScroll)NumberlineScrollingService.scrollNumberline();$scope.hoveringToScroll=!$scope.hoveringToScroll;};}]).controller('NumberlineScrollingCtrl',['$scope','$element','NumberlineScrollingService',function($scope,$element,NumberlineScrollingService){NumberlineScrollingService.onScrollNumberline($scope,function(args){if(!args)args={};args.distance=args.distance||$scope.scrollDirection+'=22';args.time=args.time||200;$element.animate({'scrollLeft':args.distance+'px'},args.time,'linear');setTimeout(function(){if($scope.hoveringToScroll)NumberlineScrollingService.scrollNumberline();},200);});$(window).on('resize',_.debounce(function(){$scope.setEdgeFadeIntensity();$scope.$apply();},100));$scope.setEdgeFadeIntensity=function(){var maxScrollLeft=$element[0].scrollWidth- $element[0].clientWidth;var currentScrollLeft=$element.scrollLeft();var leftScrollPositionToStartFading=$scope.edgeFadeWidth/2;var rightScrollPositionToStartFading=maxScrollLeft- $scope.edgeFadeWidth/2;if(maxScrollLeft===0){$scope.edgeFadePositions.left=-$scope.edgeFadeWidth;$scope.edgeFadePositions.right=-$scope.edgeFadeWidth;}
if(currentScrollLeft<=leftScrollPositionToStartFading){$scope.edgeFadePositions.left=(currentScrollLeft- leftScrollPositionToStartFading)*2;}else{$scope.edgeFadePositions.left=0;}
if(currentScrollLeft>=rightScrollPositionToStartFading){$scope.edgeFadePositions.right=(rightScrollPositionToStartFading- currentScrollLeft)*2;}else{$scope.edgeFadePositions.right=0;}};}]).controller('NumberlineCurrentQuestionCtrl',['$scope','$element','NumberlineScrollingService',function($scope,$element,NumberlineScrollingService){if($element[0].offsetLeft>window.innerWidth- $scope.edgeFadeWidth){var distanceToWindowCenter=$element[0].offsetLeft+($element.width()- window.innerWidth)/ 2;
NumberlineScrollingService.scrollNumberline({'distance':distanceToWindowCenter,'time':2000});$scope.edgeFadePositions.left=0;}}]).controller('ArticleQuestion',['$scope','$element',function($scope,$element){$scope.isAnswerVisible=false;var slug=window.JS_VARS.article_slug;var question=$element.children('.question').children('h2').text().trim();$scope.showArticleAnswerPress=function(){$scope.isAnswerVisible=!$scope.isAnswerVisible;if(!$scope.isAnswerVisible)$element.scrollTo(30,400,600);utils.track("Pressed 'Show answer'",{'slug':slug,'question':question});}
$scope.answerHeading="Answer";}]);$(document).on('mouseenter','.testimonials .carousel-indicators li',function(e){e.currentTarget.click();});var isMobileBrowser=false;(function(a,b){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))isMobileBrowser=true})(navigator.userAgent||navigator.vendor||window.opera);if(!isMobileBrowser)$('[data-toggle="tooltip"]').tooltip();if(!Object.keys){Object.keys=(function(){'use strict';var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object');}
var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop);}}
if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i]);}}}
return result;};}());}